import{_ as x,r as i,x as b,k as y,o as n,c,a as t,t as r,l as f,J as S,F as V,b as B,g as D,h as N,j as C,f as E}from"./_plugin-vue_export-helper-335f4554.js";import{S as F,b as L,a as h}from"./central-v1-c4e0d34f.js";import{T as R}from"./Toast-2332f712.js";const U={name:"TicketView",components:{StatusBadge:F,Toast:R},setup(){const u=L(),s=i(!1),k=i(null),e=i([]),l=i(""),p=i(!1),_=i("success"),m=i(""),g=i(""),d=async()=>{s.value=!0;try{const o=await h.supportTickets.get(u.params.id);o.data.success&&(k.value=o.data.data,e.value=o.data.data.messages||[])}catch(o){console.error("Error fetching ticket:",o),v("error","Error","Failed to load ticket")}finally{s.value=!1}},a=async()=>{if(l.value.trim()){s.value=!0;try{await h.supportTickets.addMessage(u.params.id,l.value),v("success","Success","Message added successfully"),l.value="",d()}catch{v("error","Error","Failed to add message")}finally{s.value=!1}}},T=o=>o?new Date(o).toLocaleString():"-",v=(o,w,M)=>{_.value=o,m.value=w,g.value=M,p.value=!0};return b(()=>{d()}),{loading:s,ticket:k,messages:e,newMessage:l,showToast:p,toastType:_,toastTitle:m,toastMessage:g,addMessage:a,formatDate:T}}},j={class:"ticket-view-page"},A={class:"page-header"},I={key:0,class:"loading"},J={key:1,class:"ticket-details"},P={class:"detail-section"},q={class:"ticket-meta"},z={class:"meta-item"},G={class:"meta-item"},H={class:"ticket-description"},K={class:"detail-section"},O={key:0,class:"empty"},Q={key:1,class:"messages-list"},W={class:"message-text"},X={class:"message-date"},Y={class:"detail-section"},Z={class:"reply-form"},$=["disabled"];function ee(u,s,k,e,l,p){var d;const _=y("router-link"),m=y("StatusBadge"),g=y("Toast");return n(),c("div",j,[t("div",A,[t("h2",null,"ðŸŽ« Ticket #"+r((d=e.ticket)==null?void 0:d.id),1),f(_,{to:"/support",class:"btn-secondary"},{default:S(()=>s[3]||(s[3]=[E("â† Back to Tickets")])),_:1})]),e.loading?(n(),c("div",I,"Loading ticket...")):e.ticket?(n(),c("div",J,[t("div",P,[t("h3",null,r(e.ticket.title),1),t("div",q,[f(m,{status:e.ticket.status||"pending"},null,8,["status"]),t("span",z,"Priority: "+r(e.ticket.priority||"medium"),1),t("span",G,"Created: "+r(e.formatDate(e.ticket.created_at)),1)]),t("div",H,[t("p",null,r(e.ticket.description||"No description"),1)])]),t("div",K,[s[4]||(s[4]=t("h3",null,"Messages",-1)),e.messages.length===0?(n(),c("div",O,"No messages yet")):(n(),c("div",Q,[(n(!0),c(V,null,B(e.messages,a=>(n(),c("div",{key:a.id,class:"message-item"},[t("p",W,r(a.message),1),t("span",X,r(e.formatDate(a.created_at)),1)]))),128))]))]),t("div",Y,[s[5]||(s[5]=t("h3",null,"Add Reply",-1)),t("div",Z,[D(t("textarea",{"onUpdate:modelValue":s[0]||(s[0]=a=>e.newMessage=a),class:"form-textarea",rows:"4",placeholder:"Type your reply..."},null,512),[[N,e.newMessage]]),t("button",{onClick:s[1]||(s[1]=(...a)=>e.addMessage&&e.addMessage(...a)),class:"btn-primary",disabled:!e.newMessage||e.loading},"Send Reply",8,$)])])])):C("",!0),f(g,{show:e.showToast,"onUpdate:show":s[2]||(s[2]=a=>e.showToast=a),type:e.toastType,title:e.toastTitle,message:e.toastMessage},null,8,["show","type","title","message"])])}const oe=x(U,[["render",ee],["__scopeId","data-v-a9efbeee"]]);export{oe as default};
