import{_ as x,r as v,x as V,o as i,c as d,a as t,g as f,h as T,K as L,u as M,F as U,b as E,t as a,j as N,f as c,w as $,l as B}from"./_plugin-vue_export-helper-80b3f0a9.js";import{a as F,S as I}from"./central-v1-ce42f893.js";const P={class:"activity-logs-page"},J={class:"filters-bar"},K={class:"search-box"},O={class:"table-container"},Q={key:0,class:"loading-overlay"},R={key:1,class:"logs-table"},q={key:0},z={class:"log-name-badge"},G={class:"log-description"},H={class:"log-subject"},W={class:"log-causer"},X={class:"action-buttons"},Y=["onClick"],Z={key:0,class:"pagination"},tt=["disabled"],et={class:"pagination-info"},st=["disabled"],at={class:"modal-body"},lt={class:"detail-item"},nt={class:"detail-item"},ot={class:"detail-item"},it={class:"detail-item"},dt={class:"detail-item"},ut={class:"detail-item"},rt={class:"detail-item"},vt={class:"properties-json"},ct={class:"detail-item"},pt={__name:"ActivityLogs",setup(gt){const p=v([]),g=v(!1),m=v(""),_=v(""),y=v(""),n=v(null),o=v({current_page:1,last_page:1,per_page:20,total:0});let k=null;const u=async(l=1)=>{g.value=!0;try{const e={page:l,per_page:o.value.per_page};m.value&&(e.search=m.value),_.value&&(e.log_name=_.value),y.value&&(e.event=y.value);const r=await F.users.activityLogs(e);r.data.success&&(p.value=r.data.data||[],r.data.meta&&(o.value=r.data.meta))}catch(e){console.error("Error loading activity logs:",e),p.value=[]}finally{g.value=!1}},D=()=>{clearTimeout(k),k=setTimeout(()=>{u(1)},500)},A=l=>l?new Date(l).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A",S=l=>l?new Date(l).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",h=l=>{if(!l)return"N/A";const e=l.split("\\");return e[e.length-1]},j=l=>l&&{created:"success",updated:"pending",deleted:"failed"}[l.toLowerCase()]||"pending",w=l=>{n.value=l},b=()=>{n.value=null};return V(()=>{u()}),(l,e)=>{var r;return i(),d("div",P,[t("div",{class:"page-header"},[e[8]||(e[8]=t("div",null,[t("h1",{class:"page-title"},"ðŸ“‹ Activity Logs"),t("p",{class:"page-subtitle"},"View all system activity logs")],-1)),t("div",{class:"page-actions"},[t("button",{class:"btn btn-secondary",onClick:u}," ðŸ”„ Refresh ")])]),t("div",J,[t("div",K,[f(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=s=>m.value=s),placeholder:"Search logs...",class:"search-input",onInput:D},null,544),[[T,m.value]])]),f(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>_.value=s),class:"filter-select",onChange:e[2]||(e[2]=s=>u(1))},e[9]||(e[9]=[M('<option value="" data-v-9199d56e>All Types</option><option value="user" data-v-9199d56e>User</option><option value="admin" data-v-9199d56e>Admin</option><option value="tenant" data-v-9199d56e>Tenant</option><option value="package" data-v-9199d56e>Package</option>',5)]),544),[[L,_.value]]),f(t("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>y.value=s),class:"filter-select",onChange:e[4]||(e[4]=s=>u(1))},e[10]||(e[10]=[t("option",{value:""},"All Events",-1),t("option",{value:"created"},"Created",-1),t("option",{value:"updated"},"Updated",-1),t("option",{value:"deleted"},"Deleted",-1)]),544),[[L,y.value]])]),t("div",O,[g.value?(i(),d("div",Q,e[11]||(e[11]=[t("div",{class:"spinner"},null,-1),t("p",null,"Loading activity logs...",-1)]))):(i(),d("table",R,[e[13]||(e[13]=t("thead",null,[t("tr",null,[t("th",null,"ID"),t("th",null,"Log Name"),t("th",null,"Description"),t("th",null,"Subject"),t("th",null,"Causer"),t("th",null,"Event"),t("th",null,"Date"),t("th",null,"Actions")])],-1)),t("tbody",null,[p.value.length===0?(i(),d("tr",q,e[12]||(e[12]=[t("td",{colspan:"8",class:"empty-cell"}," No activity logs found ",-1)]))):(i(!0),d(U,{key:1},E(p.value,s=>{var C;return i(),d("tr",{key:s.id},[t("td",null,a(s.id),1),t("td",null,[t("span",z,a(s.log_name||"N/A"),1)]),t("td",null,[t("div",G,a(s.description||"-"),1)]),t("td",null,[t("div",H,a(h(s.subject_type))+" #"+a(s.subject_id||"-"),1)]),t("td",null,[t("div",W,a(((C=s.causer)==null?void 0:C.name)||s.causer_type||"-"),1)]),t("td",null,[B(I,{status:j(s.event)},null,8,["status"])]),t("td",null,a(A(s.created_at)),1),t("td",null,[t("div",X,[t("button",{class:"btn-icon",onClick:mt=>w(s),title:"View Details"}," ðŸ‘ï¸ ",8,Y)])])])}),128))])]))]),!g.value&&p.value.length>0&&o.value.last_page>1?(i(),d("div",Z,[t("button",{class:"pagination-btn",disabled:o.value.current_page===1,onClick:e[5]||(e[5]=s=>u(o.value.current_page-1))}," â† Previous ",8,tt),t("span",et," Page "+a(o.value.current_page)+" of "+a(o.value.last_page)+" ("+a(o.value.total)+" total) ",1),t("button",{class:"pagination-btn",disabled:o.value.current_page>=o.value.last_page,onClick:e[6]||(e[6]=s=>u(o.value.current_page+1))}," Next â†’ ",8,st)])):N("",!0),n.value?(i(),d("div",{key:1,class:"modal-overlay",onClick:b},[t("div",{class:"modal-content",onClick:e[7]||(e[7]=$(()=>{},["stop"]))},[t("div",{class:"modal-header"},[e[14]||(e[14]=t("h3",null,"ðŸ“‹ Log Details",-1)),t("button",{class:"modal-close",onClick:b},"Ã—")]),t("div",at,[t("div",lt,[e[15]||(e[15]=t("strong",null,"ID:",-1)),c(" "+a(n.value.id),1)]),t("div",nt,[e[16]||(e[16]=t("strong",null,"Log Name:",-1)),c(" "+a(n.value.log_name||"N/A"),1)]),t("div",ot,[e[17]||(e[17]=t("strong",null,"Description:",-1)),c(" "+a(n.value.description||"-"),1)]),t("div",it,[e[18]||(e[18]=t("strong",null,"Subject:",-1)),c(" "+a(h(n.value.subject_type))+" #"+a(n.value.subject_id||"-"),1)]),t("div",dt,[e[19]||(e[19]=t("strong",null,"Causer:",-1)),c(" "+a(((r=n.value.causer)==null?void 0:r.name)||n.value.causer_type||"-"),1)]),t("div",ut,[e[20]||(e[20]=t("strong",null,"Event:",-1)),c(" "+a(n.value.event||"-"),1)]),t("div",rt,[e[21]||(e[21]=t("strong",null,"Properties:",-1)),t("pre",vt,a(JSON.stringify(n.value.properties||{},null,2)),1)]),t("div",ct,[e[22]||(e[22]=t("strong",null,"Created At:",-1)),c(" "+a(S(n.value.created_at)),1)])]),t("div",{class:"modal-footer"},[t("button",{class:"btn btn-secondary",onClick:b},"Close")])])])):N("",!0)])}}},bt=x(pt,[["__scopeId","data-v-9199d56e"]]);export{bt as default};
