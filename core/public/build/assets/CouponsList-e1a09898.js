import{_ as $,r as c,x as w,k as N,o as l,c as u,a as t,l as m,J as A,g as y,h as L,K as T,F as V,b as E,t as o,j as F,f as B,n as I}from"./_plugin-vue_export-helper-25c71bc9.js";import{u as M,a as f,S as U}from"./central-v1-43971805.js";const K={class:"coupons-page"},P={class:"page-header"},j={class:"filters-bar"},z={class:"search-box"},J={class:"table-container"},Q={key:0,class:"loading-overlay"},R={key:1,class:"coupons-table"},W={key:0},q={class:"code-badge"},G={class:"action-buttons"},H=["onClick"],O=["onClick"],X={key:0,class:"pagination"},Y=["disabled"],Z={class:"pagination-info"},tt=["disabled"],et={__name:"CouponsList",setup(st){const h=M(),d=c([]),p=c(!1),v=c(""),_=c(""),n=c({current_page:1,last_page:1,per_page:20,total:0});let g=null;const i=async(a=1)=>{p.value=!0;try{const e={page:a,per_page:n.value.per_page};v.value&&(e.search=v.value),_.value!==""&&(e.status=_.value);const r=await f.coupons.list(e);r.data.success&&(d.value=r.data.data,r.data.meta&&(n.value=r.data.meta))}catch(e){console.error("Error loading coupons:",e),d.value=[]}finally{p.value=!1}},C=()=>{clearTimeout(g),g=setTimeout(()=>{i(1)},500)},k=(a,e)=>e==="percentage"?`${a}%`:`${a} KWD`,b=a=>a?new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A",x=a=>{h.push(`/coupons/edit/${a.id}`)},D=async a=>{if(confirm(`Are you sure you want to delete coupon "${a.code}"?`))try{await f.coupons.delete(a.id),await i(n.value.current_page)}catch(e){console.error("Error deleting coupon:",e),alert("Failed to delete coupon")}};return w(()=>{i()}),(a,e)=>{const r=N("router-link");return l(),u("div",K,[t("div",P,[e[6]||(e[6]=t("div",null,[t("h1",{class:"page-title"},"ðŸŽ« All Coupons"),t("p",{class:"page-subtitle"},"Manage discount coupons")],-1)),m(r,{to:"/coupons/create",class:"btn btn-primary"},{default:A(()=>e[5]||(e[5]=[B(" âž• Create New Coupon ")])),_:1})]),t("div",j,[t("div",z,[y(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=s=>v.value=s),placeholder:"Search coupons...",class:"search-input",onInput:C},null,544),[[L,v.value]])]),y(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>_.value=s),class:"filter-select",onChange:e[2]||(e[2]=s=>i(1))},e[7]||(e[7]=[t("option",{value:""},"All Status",-1),t("option",{value:"1"},"Active",-1),t("option",{value:"0"},"Inactive",-1)]),544),[[T,_.value]])]),t("div",J,[p.value?(l(),u("div",Q,e[8]||(e[8]=[t("div",{class:"spinner"},null,-1),t("p",null,"Loading coupons...",-1)]))):(l(),u("table",R,[e[10]||(e[10]=t("thead",null,[t("tr",null,[t("th",null,"ID"),t("th",null,"Code"),t("th",null,"Discount"),t("th",null,"Type"),t("th",null,"Expires"),t("th",null,"Status"),t("th",null,"Created At"),t("th",null,"Actions")])],-1)),t("tbody",null,[d.value.length===0?(l(),u("tr",W,e[9]||(e[9]=[t("td",{colspan:"8",class:"empty-cell"}," No coupons found ",-1)]))):(l(!0),u(V,{key:1},E(d.value,s=>(l(),u("tr",{key:s.id},[t("td",null,o(s.id),1),t("td",null,[t("code",q,o(s.code),1)]),t("td",null,[t("strong",null,o(k(s.discount,s.discount_type)),1)]),t("td",null,[t("span",{class:I(["type-badge",s.discount_type])},o(s.discount_type==="percentage"?"%":"Fixed"),3)]),t("td",null,o(b(s.expire_date)),1),t("td",null,[m(U,{status:s.status?"active":"inactive"},null,8,["status"])]),t("td",null,o(b(s.created_at)),1),t("td",null,[t("div",G,[t("button",{class:"btn-icon",onClick:S=>x(s),title:"Edit"}," âœï¸ ",8,H),t("button",{class:"btn-icon btn-danger",onClick:S=>D(s),title:"Delete"}," ðŸ—‘ï¸ ",8,O)])])]))),128))])]))]),!p.value&&d.value.length>0&&n.value.last_page>1?(l(),u("div",X,[t("button",{class:"pagination-btn",disabled:n.value.current_page===1,onClick:e[3]||(e[3]=s=>i(n.value.current_page-1))}," â† Previous ",8,Y),t("span",Z," Page "+o(n.value.current_page)+" of "+o(n.value.last_page)+" ("+o(n.value.total)+" total) ",1),t("button",{class:"pagination-btn",disabled:n.value.current_page>=n.value.last_page,onClick:e[4]||(e[4]=s=>i(n.value.current_page+1))}," Next â†’ ",8,tt)])):F("",!0)])}}},ot=$(et,[["__scopeId","data-v-626b7156"]]);export{ot as default};
